<!DOCTYPE html>
</main>


<noscript>
<meta http-equiv="refresh" content="0; url=./index.html">
<p style="text-align:center;color:#fff">JavaScript is required.</p>
</noscript>


<script>
"use strict";
// Always clear any prior session when viewing login
function clearSession(){
localStorage.removeItem("authToken");
localStorage.removeItem("authExp");
}
clearSession();


// If the page is restored from back/forward cache, clear again & reset inputs
window.addEventListener("pageshow", (e) => {
if (e.persisted) {
clearSession();
const u = document.getElementById("username");
const p = document.getElementById("password");
if (u) u.value = "";
if (p) p.value = "";
}
});


function showErr(msg){
const el = document.getElementById("err");
el.textContent = msg;
el.style.display = "block";
}


function genToken(){
if (window.crypto && crypto.randomUUID) return crypto.randomUUID();
if (window.crypto && crypto.getRandomValues){
const arr = new Uint32Array(4);
crypto.getRandomValues(arr);
return Array.from(arr, n => n.toString(16)).join("-");
}
return (Date.now().toString(36) + Math.random().toString(36).slice(2));
}


document.getElementById("loginForm").addEventListener("submit", function (e) {
e.preventDefault();
const btn = document.getElementById("loginBtn");
btn.disabled = true;
const u = document.getElementById("username").value.trim();
const p = document.getElementById("password").value;


if (!u || !p) {
showErr("Please enter username and password.");
btn.disabled = false;
return;
}


// Demo login. Replace with real backend when ready.
if (u.toLowerCase() === "researcher" && p === "pass123") {
const token = genToken();
const oneHour = 60 * 60 * 1000; // adjust to taste
localStorage.setItem("authToken", token);
localStorage.setItem("authExp", String(Date.now() + oneHour));
window.location.href = "./researcher.html";
} else {
showErr("Invalid credentials.");
btn.disabled = false;
}
});
</script>
</body>
</html>
